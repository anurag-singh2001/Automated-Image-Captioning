<!DOCTYPE html>
<html>

<head>
    <title>Home page</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='index.js') }}">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                },
            },
        };
    </script>
</head>

<body>
    <header class="p-4 mb-4 flex justify-between items-center">
        <div class="max-w-5xl">
            <h1 class="text-2xl font-bold">Automated Image Captioning</h1>
        </div>
        <div class="flex items-center">
            <button class="btn btn-primary">
                Login
            </button>
        </div>
    </header>
    <main class="flex flex-col">
        <div class="flex flex-col-reverse algin-center justify-center p-10 m-auto md:max-w-4xl md:flex-row">
            <div class="w-full md:w-2/3 mr-24">
                <h1 class="text-3xl font-bold mb-5 md:text-4xl">Welcome to Automated Image Captioning</h1>
                <p class="mb-4">Enhance image accessibility and searchability using our state-of-the-art AI-powered technology for image text recognition. Within seconds, our system generates precise, natural-language descriptions, making it perfect for various platforms such as online stores, blogs, news websites, and beyond.</p>
                <p>Our innovative AI technology analyzes images and generates descriptive captions automatically. This feature ensures that users can efficiently search for and comprehend image content across different digital platforms.</p>
            </div>

            <div class="w-full md:w-1/3 self-center">
                <div class="uploadOuter">
                    <form id="imageUploadForm" action="/upload" method="post" enctype="multipart/form-data">
                        <input type="file" name="file" accept="image/*" class="hidden" id="uploadFile"
                            onchange="dragNdrop(event)">
                        <label for="uploadFile" class="btn btn-primary" type="submit" value="Upload">Upload
                            Image</label>
                        <strong>OR</strong>
                        <span class="dragBox" ondragover="drag()" ondrop="drop()">
                            Drag and Drop image here
                        </span>
                    </form>
                </div>
            </div>
        </div>
        <div class="caption-container">
            <div id="preview"></div>
            <p id="caption">{{caption}}</p>
        </div>
    </main>



    <script>
        function dragNdrop(event) {
            var fileName = URL.createObjectURL(event.target.files[0]);
            var preview = document.getElementById("preview");
            var previewImg = document.createElement("img");
            previewImg.setAttribute("src", fileName);
            preview.innerHTML = "";
            preview.appendChild(previewImg);

            var form = document.getElementById('imageUploadForm');
            var formData = new FormData(form);

            var xhr = new XMLHttpRequest();
            xhr.open('POST', form.action, true);
            xhr.onload = function () {
                if (xhr.status === 200) {
                    var response = xhr.responseText;
                    console.log('Response:', response); // Log the response
                    document.getElementById('caption').innerText = response;
                    document.getElementById('uploaded_image').src = fileName;
                    document.getElementById('uploaded_image').style.display = 'block';
                }
            };
            xhr.send(formData);
        }

        function drag() {
            document.getElementById('uploadFile').parentNode.className = 'draging dragBox';
        }

        function drop() {
            document.getElementById('uploadFile').parentNode.className = 'dragBox';
        }
    </script>
</body>

</html>